#!/usr/bin/env ruby
# coding: utf-8

require 'yaml'

# load library
file = File.symlink?(__FILE__) ? File.readlink(__FILE__) : __FILE__
lib = File.join File.dirname(file), "/../lib/beeminder"

if File.exists? lib
  # using local version
  require lib
else
  require 'beeminder'
end

config = "#{Dir.home}/.beeminderrc"
if not File.exists? config
  # create config
  require 'highline/import'
  yaml = {
    "account" => ask("Beeminder account:"),
    "token"   => ask("Auth token:")
  }
  File.open(config, "w+") {|f| YAML.dump yaml, f}
  File.chmod 0600, config
  puts "Written config to '#{config}.'"
end

# load config
yaml = YAML.load File.open(config)

# login
bee = Beeminder::User.new yaml["account"], yaml["token"]

# show goals
# p bee.goals
